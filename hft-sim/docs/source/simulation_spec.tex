\documentclass[11pt]{article}
\usepackage[margin=1in]{geometry}
\usepackage{color,soul,hyperref,url}
\usepackage{graphicx,amstext}
\usepackage{subfigure}
\usepackage{amsmath}
\usepackage{enumerate}
\usepackage{listings}
\usepackage{paralist}
\usepackage{array}
\usepackage{booktabs}
\usepackage{tabulary}

\newcommand{\email}[1]{\href{mailto:#1}{\texttt{#1}}}

\lstset{
  basicstyle=\ttfamily,
  breaklines=true
}


\begin{document}
	
\title{Simulation Spec File}
\author{
  Erik Brinkman \\
  \email{erik.brinkman@umich.edu}
  \and
  Elaine Wah \\
  \email{ewah@umich.edu}
}
\date{Updated: \today}
\maketitle

\section{Introduction}

The simulation spec file contains the entire configuration of a simulation. It
is in \href{https://en.wikipedia.org/wiki/Json}{JSON} format and divided into
two main sections: ``assignment,'' and ``configuration.''

The parameters in the specification file are those that can be adjusted in
simulations. Below is the example \path{simulation_spec.json} file found in
the \path{docs} folder:

\lstinputlisting{../simulation_spec.json}

\section{Assignment}

The ``assignment'' section is primarily for use with EGTA. It contains a
nested listing of player roles with strategies assigned to players. 
%
There are currently three agent roles:
 \begin{description}
  \item[\texttt{BACKGROUND}:] Background traders, who possess a private valuation for the security.
  \item[\texttt{MARKETMAKER}:] Marker makers, who do not have private values.
  \item[\texttt{HFT}:] High-frequency traders.
  \end{description}

Each role used in the simulation is followed by a list of agent-strategy pairs, which take the format \texttt{<agentType>:<key>\_<value1>\_<key>\_<value2>...}. Each agent present in the simulation is specified on its own line.
%
For example, the section below specifies two background traders, one with range $[0, 5000]$ and one with range $[0, 1000]$, and a single market maker employing the \textsc{BasicMM} strategy with $100$ rungs:
%
\begin{lstlisting}
{
    "assignment": {
        "BACKGROUND": [
            "ZIR:rMin_0_rMax_1000",
            "ZIR:rMin_0_rMax_5000"
        ],
        "MARKETMAKER": [
            "BASICMM:k_100"
        ]
    }
    ...
}
\end{lstlisting}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Configuration}

\begin{table}
\centering
\begin{tabulary}{\textwidth}{lcL}\toprule
\textbf{Name}   & \textbf{Default} & \textbf{Description} \\ \midrule

\texttt{numSims} 		& 1 & Number of simulations to pre-aggregate; e.g., setting this parameter to 5 will generate observation files containing mean values from 5 simulation runs. \\
\texttt{randomSeed} 	& system time & Seed for the pseudorandom number generator. Random number generation is linked to the observation number, therefore a sequence of observations 0 to N will have different random numbers even when run with the same simulation spec file (and the same seed). Entering the same random seed for different models allows comparison with simulations run with common random numbers. \\
\texttt{presets}  		& \emph{(undefined)} & \texttt{CENTRALCDA},
\texttt{TWOMARKET}, \texttt{CENTRALCALL}, \texttt{TWOMARKETLA}, or \texttt{MAXEFF} \\

\texttt{simLength} 	& 60000 & Length of simulation in time ticks (usually interpreted as milliseconds). \\ 
\texttt{nbboLatency} 	& 0 & Latency to update both the NBBO quote through the SIP in time steps (usually interpreted in milliseconds).\\
\texttt{marketLatency} 	& 0 & Default quote \& transaction update latency for
all markets. \\
\texttt{laLatency} 	& 0 & Latency of the latency arbitrageur \\


\texttt{reentryRate} 	& 0.005 & Rate of entry / reentry for all
agents. MarketMakers also enter time 0. HFT agents never enter via normal
reentry. Can also be set for an agent individually, if part of its strategy.\\
\texttt{backgroundReentryRate} & \texttt{reentryRate} & Used by background agent if in agent constructor \\
\texttt{marketmakerReentryRate} & \texttt{reentryRate} & Used by market maker if in agent constructor \\

\texttt{tickSize} 		& 1 & Prices are integers, so the smallest tick size is $1$. \\

\texttt{maxPosition} 	& 10 & Max position (long or short) for background agents. \\
\texttt{privateValueVar} & 1E6 & Variance of normally distributed i.i.d. elements of private value array; only applicable to background agents. \\
\texttt{fundamentalMean} 	& 100000 & Mean for the public global fundamental value.\\
\texttt{fundamentalKappa} 		& 0.05 & Mean-reversion parameter for the fundamental; higher kappa indicates greater degree of mean-reversion.\\
\texttt{fundamentalShockVar} 		& 1E6 & Variance of shock to global fundamental (which is normally distributed around mean 0).\\
\texttt{discountFactors} & [0] & A list of the discount factors agents should use when
calculating utility. The first discount factor is also what is used to
calculate payoff when an agent is a player. \\
\bottomrule
\end{tabulary}
\caption{List of environment configuration parameters.}
\label{tab:configs}
\end{table}

The ``configuration'' section specifies the parameters for the market environment as well as the agent population present.
%
An explanation of select parameters follows (also see Table \ref{tab:configs}):

\begin{description}

\item[\texttt{presets}:] This is a way to get easy access to ``standard'' market
  configurations. Currently there are four options:
  \begin{description}
  \item[\texttt{CENTRALCDA}:] A single CDA Market.
  \item[\texttt{CENTRALCALL}:] A single CALL Market that clears at the \texttt{nbboLatency}.
  \item[\texttt{TWOMARKET}:] Two CDA markets and no latency arbitrageur.
  \item[\texttt{TWOMARKETLA}:] Two CDA markets and a single latency arbitrageur.
  \item[\texttt{MAXEFF}:] One call market, 66 background agents with max position 10.
  \end{description}
  
  %%%%%%%%%%%
\item[Markets:] The next set of options allow manually specifying market configurations
  if a preset is not used. Currently, there are two types of markets: \texttt{CDA} and \texttt{CALL}. The configuration string takes the format
  \texttt{<key1>\_<value1>\_<key>\_<value2>\_...}, and can contain several comma-separated configurations. The following entry would create three CALL
  markets. Two of these will clear every 100 ms, and one will clear every
  second:

\begin{verbatim}
"CALL" : "num_2_clearInterval_100,num_1_clearInterval_1000"
\end{verbatim}

Refer to Table \ref{tab:mkt} for details on market-specific settings.

\begin{table}
\centering
\begin{tabulary}{\textwidth}{lcL} \toprule
\textbf{Market parameter}   & \textbf{Default} & \textbf{Description} \\ \midrule
\texttt{num} & 0 & Number of markets with a specific market configuration \\
\texttt{clearInterval} & 1000 & Length of clearing interval of \texttt{CALL} market \\
\texttt{pricingPolicy} & 0.5 & \texttt{CALL} market pricing policy \\
\bottomrule
\end{tabulary}
\caption{List of market configuration parameters.}
\label{tab:mkt}
\end{table}

%%%%%%%%%%
\item[Agents:] The next set of options allow manually specifying agent
  configurations (NOTE: LA configurations can only be set if a \texttt{preset} is not being used). 
   Each agent takes a configuration string identical in style to a market, except agents
  will take different parameters. See Table \ref{tab:ag} for details.
  
  The current agents available are \texttt{BASICMM}, \texttt{MAMM}, \texttt{WMAMM}, \texttt{ADAPTIVEMM}, \texttt{FUNDAMENTALMM},
  \texttt{ZI}, \texttt{ZIR}, \texttt{ZIRP} \texttt{ZIP}, \texttt{AA}, and \texttt{LA}.
  

\end{description}

\begin{table}
\centering
\begin{tabulary}{\textwidth}{lcL}\toprule
\textbf{Agent parameter} & \textbf{Default} & \textbf{Description} \\ \midrule
\texttt{num}			& 0	& Number of a specific agent configuration \\
\texttt{withdraw}		& \texttt{true}	& If true, withdraws orders upon each reentry \\
\texttt{window}		& 5000	& Length of window to process, for \texttt{WindowAgents} \\


\\ \toprule
\textbf{LA parameter}   & \textbf{Default} & \textbf{Description} \\ \midrule
\texttt{alpha}			& 0.001 & Profit threshold of LA \\
\texttt{laLatency}		& 0  & Latency of LA \\

\\ \toprule
\textbf{ZI parameter}   & \textbf{Default} & \textbf{Description} \\ \midrule
\texttt{Rmin}			& 0	& Bid range minimum \\
\texttt{Rmax}			& 5000	& Bid range maximum \\
\texttt{thresh}		& 0.001 & Profit threshold of \texttt{ZIRP} \\

\\ \toprule
\textbf{MM parameter}   & \textbf{Default} & \textbf{Description} \\ \midrule
\texttt{K}			& 100	& Number of rungs on each side of the ladder \\
\texttt{size}			& 100	& Rung size \\
\texttt{trunc}		& \texttt{true} & If true, will truncate the ladder to avoid crossing current quote \\
\texttt{tickOutside}	& \texttt{false} & If true, given ladder center prices that match the \textit{BID} and \textit{ASK}, will modify to be \emph{outside} the quote by 1 tick (that is, lower than the  \textit{BID}, higher than the  \textit{ASK}) \\
\texttt{tickImprove}	& \texttt{true} & If true, will modify ladder central if matches the current price quote (on either side) \\
\texttt{initLadderMean} & \texttt{meanValue} & Ladder center initialization \\
\texttt{initLadderRange} & 1000 & Ladder spread initialization \\

\texttt{spread} & -1 &	 Constant spread for \textsc{FundMM} ladder. If this is nonpositive, MM uses the spread of the most recent price quote for the spread of its ladder. \\
\texttt{N} 	& 5 & Number of historical prices (quotes) to use \\
\texttt{W} 	& 0 & Weight factor $\in [0,1)$ for \textsc{WMAMM}; if 0, linearly weighted, otherwise exponentially weighted. \\

\texttt{median} 	& \texttt{false}	& If true, \texttt{AdaptiveMM} will use median spread-based strategy \\
\texttt{fastLearn}	 & \texttt{true} & If true, \texttt{AdaptiveMM} will use modification to learn more quickly (for updating G) \\
\texttt{lastPrice} & \texttt{true} & If true, \texttt{AdaptiveMM} will use the last price, rather than the current price, to evaluate each spread-based strategy's performance \\
\texttt{strats} 	& 500, 1000, 2500, 5000 & Initial spreads for strategies used by \texttt{AdaptiveMM}. Delimited in strategy string by hyphen ``\texttt{-}'' \\
\bottomrule
\end{tabulary}
\caption{Incomplete list of agent configuration parameters. AAAgent and ZIPAgent parameters will eventually be converted into groups, and thus are not included here. Note that all boolean parameters can be specified by ``T/t'' and ``F/f'' in addition to ``true'' and ``false.''}
\label{tab:ag}
\end{table}


\end{document}
